#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "🚀 Running pre-push checks (E2E tests)..."

# Run E2E tests using Makefile command
echo "🔍 Running E2E tests..."
if make e2e; then
    echo "✅ E2E tests passed!"
    echo ""
    echo "✅ All pre-push checks passed!"
    echo "🚀 Push allowed - E2E tests confirmed deployment readiness"
else
    echo ""
    echo "❌ E2E tests failed!"
    echo "🚫 Push blocked - fix failing E2E tests before pushing"
    echo ""
    echo "🔧 Debugging tips:"
    echo "   • Check if backend is running: make dev-status"
    echo "   • Run E2E tests manually: make e2e"
    echo "   • View detailed logs: make e2e-debug"
    echo "   • Reset environment: make reset-env"
    echo ""
    exit 1
fi